# Railway 部署指南

## 🚨 重要問題：資料丟失問題

### 問題描述
Railway 的檔案系統是**暫時性的**，每次部署都會清空以下內容：
- ❌ `public/uploads/` 目錄中的所有圖片
- ❌ 上傳的菜單圖片
- ❌ 產品詳情圖片
- ❌ 任何存儲在文件系統中的資料

### 影響範圍
- 菜單管理頁面：圖片顯示「載入失敗」
- 產品詳情頁面：圖片無法顯示
- 用戶體驗：每次部署後需要重新上傳所有圖片

## 🛠️ 解決方案

### 方案 1：使用 Railway 持久化存儲（推薦）
```json
// railway.json
{
  "volumes": [
    {
      "name": "uploads",
      "mountPath": "/app/public/uploads"
    }
  ]
}
```

### 方案 2：使用外部圖片存儲服務
- AWS S3
- Cloudinary
- Google Cloud Storage
- Azure Blob Storage

### 方案 3：資料庫存儲（已實現）
- 將圖片以 base64 格式存儲在資料庫中
- 通過 `/api/image/[id]` 路由提供圖片服務
- 優點：資料不會丟失
- 缺點：資料庫大小增加

## 📋 當前狀態

### 已實現的功能
- ✅ 資料庫圖片存儲模型
- ✅ 圖片 API 路由
- ✅ 圖片存儲工具函數

### 需要完成的工作
- [ ] 修改圖片上傳邏輯使用資料庫存儲
- [ ] 更新菜單 API 使用新的圖片 URL
- [ ] 測試資料庫圖片存儲功能

## 🚀 部署建議

### 短期解決方案
1. 使用 Railway 持久化存儲（方案 1）
2. 在 Railway 控制台添加 Volume

### 長期解決方案
1. 遷移到外部圖片存儲服務
2. 實現圖片 CDN 加速
3. 添加圖片壓縮和優化

## ⚠️ 注意事項

1. **每次部署前**：備份重要資料
2. **測試環境**：先在測試環境驗證解決方案
3. **監控**：監控資料庫大小和性能
4. **備份**：定期備份資料庫

## 📞 聯繫方式

如有問題，請聯繫開發團隊。
